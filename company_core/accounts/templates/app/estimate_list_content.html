{% load custom_filters %}
<div class="table-responsive">
    <table class="table table-striped table-bordered">
        <thead class="thead-dark">
            <tr>
                <!-- Estimate Number -->
                <th>
                    <a href="?sort_by=estimate_number&order={% if sort_by == 'estimate_number' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Estimate Number
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'estimate_number' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'estimate_number' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Date -->
                <th>
                    <a href="?sort_by=date&order={% if sort_by == 'date' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Date
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'date' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'date' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Bill To -->
                <th>
                    <a href="?sort_by=bill_to&order={% if sort_by == 'bill_to' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Bill To
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'bill_to' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'bill_to' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Vin no -->
                <th>
                    <a href="?sort_by=vin_no&order={% if sort_by == 'vin_no' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Vin no
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'vin_no' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'vin_no' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Unit no -->
                <th>
                    <a href="?sort_by=unit_no&order={% if sort_by == 'unit_no' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Unit no
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'unit_no' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'unit_no' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Total Amount -->
                <th>
                    <a href="?sort_by=total_amount&order={% if sort_by == 'total_amount' and order == 'asc' %}desc{% else %}asc{% endif %}" class="sortable-column">
                        Total Amount
                        <span class="sort-arrows">
                            <i class="fas fa-sort-up {% if sort_by == 'total_amount' and order == 'asc' %}active-sort{% endif %}"></i>
                            <i class="fas fa-sort-down {% if sort_by == 'total_amount' and order == 'desc' %}active-sort{% endif %}"></i>
                        </span>
                    </a>
                </th>
                <!-- Actions -->
                <th class="text-center">Actions</th>
            </tr>
        </thead>
        <tbody>
            {% for estimate in object_list %}
            <tr class="invoice-row" data-amount="{{ estimate.total_amount }}">
                <td data-label="Estimate Number">
                    <a href="{% url 'accounts:estimate_detail' estimate.pk %}" class="btn btn-info btn-sm mb-1 mr-2">
                        {{ estimate.estimate_number }}
                    </a>
                </td>
                <td data-label="Date">{{ estimate.date|date:"M d, Y" }}</td>
                <td data-label="Bill To">{{ estimate.bill_to }}</td>
                <td data-label="Vin no">{{ estimate.vin_no }}</td>
                <td data-label="Unit no">{{ estimate.unit_no }}</td>
                <td data-label="Total Amount">{{ estimate.total_amount|currency }}</td>
                <td data-label="Actions" class="text-center">
                    <div class="dropdown">
                        <button class="btn btn-secondary btn-sm dropdown-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            &#8942;
                        </button>
                        <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="{% url 'accounts:estimate_detail' estimate.pk %}">View</a>
                            <a class="dropdown-item" href="{% url 'accounts:estimate_edit' estimate.pk %}">Edit</a>
                            <a class="dropdown-item" href="{% url 'accounts:estimate_delete' estimate.pk %}">Delete</a>
                        </div>
                    </div>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="7" class="text-center">No estimates found.</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
